!function(a){"use strict";var b=a.extend({viewCommentSelector:"#preview-action .preview",editCommentTitleSelector:".wrap h2:first",listReviewsTitleSelector:".wrap h2:first",ratingsReviewsmetaboxSelector:"#gravityview_ratings_reviews_entry"},GV_RATINGS_REVIEWS_ADMIN);b.init=function(){b._holder=".gv-star-rate-holder",b._star=".gv-star-rate",b._input=".gv-star-rate-field",b.isEditReviewScreen()&&(b.changeEditCommentTitle(),b.removeViewCommentButton(),b.bindRate()),b.isListReviewsScreen()&&b.changeListReviewsTitle(),b.isGravityViewScreen()&&(b.bindToHideViewConfig(),b.bindToShowViewConfig())},b.removeViewCommentButton=function(){a(b.viewCommentSelector).remove()},b.changeEditCommentTitle=function(){a(b.editCommentTitleSelector).text(b.edit_review_title)},b.bindRate=function(){b.starHolder=a(b._holder),b.star=b.starHolder.find(b._star),b.star.on("click touchend",b.starRateReview).on("mouseover",b.mouseOverStar).on("mouseout",b.mouseOutStar),b.initStarVal(),b.voteHolder=a(".gv-vote-rate-holder"),b.vote=a("a.gv-vote-up, a.gv-vote-down",b.voteHolder),b.vote.on("click touchend",b.voteRateReview),b.initVoteVal()},b.initStarVal=function(){b.starHolder.length&&b.setStars()},b.mouseOverStarHolder=function(b){a(".gv-star-rate").removeClass("gv-rate-mutated")},b.mouseOutStarHolder=function(a){b.setStars()},b.setStars=function(){var b=parseInt(a("#gv_review_rate").val(),10);b>=1&&b<=5&&a(".gv-star-rate:eq("+(b-1)+")").trigger("click")},b.mouseOverStar=function(c){var d=a(this),e=d.parents(b._holder),f=e.find(b._star),g=f.index(d);f.removeClass("gv-rate-mutated").each(function(b,c){var d=a(c);b>=g+1||d.addClass("gv-rate-mutated")})},b.mouseOutStar=function(c){var d=a(this),e=d.parents(b._holder),f=e.find(b._star);f.index(d);f.not('[data-selected="1"]').removeClass("gv-rate-mutated")},b.starRateReview=function(c){var d=a(this),e=d.parents(b._holder),f=e.find(b._star),g=e.siblings(b._input),h=f.index(d);g.val(h+1),f.removeClass("gv-rate-mutated").attr("data-selected",0).each(function(b,c){var d=a(c);b>=h+1||d.addClass("gv-rate-mutated").attr("data-selected",1)})},b.initVoteVal=function(){if(b.voteHolder.length){var c=parseInt(a("#gv_review_rate").val(),10);-1===c?a(".gv-vote-down").addClass("gv-rate-mutated").removeClass("on"):1===c&&a(".gv-vote-up").addClass("gv-rate-mutated").removeClass("on")}},b.voteRateReview=function(c){var d=a(c.target),e=0;return d.hasClass("gv-vote-up")?e=d.hasClass("gv-rate-mutated")?0:1:d.hasClass("gv-vote-down")&&(e=d.hasClass("gv-rate-mutated")?0:-1),a(".gv-rate-mutated",b.voteHolder).not(d).removeClass("gv-rate-mutated"),d.toggleClass("gv-rate-mutated"),a("#gv_review_rate").val(e),a(".gv-vote-rating-text",b.voteHolder).text(e),!1},b.changeListReviewsTitle=function(){a(b.listReviewsTitleSelector).html(b.list_reviews_title)},b.bindToHideViewConfig=function(){a(document).bind("gv_admin_views_hideViewConfig",b.hideMetabox)},b.bindToShowViewConfig=function(){a(document).bind("gv_admin_views_showViewConfig",b.showMetabox)},b.showMetabox=function(){a(b.ratingsReviewsmetaboxSelector).slideDown(150)},b.hideMetabox=function(){a(b.ratingsReviewsmetaboxSelector).slideUp(150)},b.isEditReviewScreen=function(){return"comment"===b.screen_id&&b.is_review},b.isListReviewsScreen=function(){return b.is_list_reviews},b.isGravityViewScreen=function(){return"gravityview"===b.screen_id},a(b.init)}(jQuery);